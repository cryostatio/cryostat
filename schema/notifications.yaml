asyncapi: 2.6.0
info:
  title: Cryostat WebSocket Notifications
  version: 4.2.0-SNAPSHOT
  description: Real-time notifications emitted by Cryostat for various events including
    recording lifecycle, target discovery, diagnostic operations, and more. Clients
    connect to the WebSocket endpoint and receive notifications as JSON messages.
  contact:
    name: Cryostat Development Team
    url: https://cryostat.io
    email: cryostat-development@googlegroups.com
  license:
    name: Apache 2.0
    url: https://www.apache.org/licenses/LICENSE-2.0
servers:
  production:
    url: ws://localhost:8181/api/notifications
    protocol: ws
    description: WebSocket notification endpoint
channels:
  /api/notifications:
    description: Subscribe to receive all Cryostat notifications
    subscribe:
      summary: Subscribe to Cryostat notifications
      description: Clients connect to this WebSocket endpoint to receive real-time
        notifications about events occurring in Cryostat.
      message:
        oneOf:
        - $ref: '#/components/messages/ArchiveRecordingFailure'
        - $ref: '#/components/messages/ArchiveRecordingSuccess'
        - $ref: '#/components/messages/CredentialsDeleted'
        - $ref: '#/components/messages/CredentialsStored'
        - $ref: '#/components/messages/CredentialsUpdated'
        - $ref: '#/components/messages/GrafanaUploadFailure'
        - $ref: '#/components/messages/GrafanaUploadSuccess'
        - $ref: '#/components/messages/HeapDumpFailure'
        - $ref: '#/components/messages/HeapDumpSuccess'
        - $ref: '#/components/messages/ProbeTemplateApplied'
        - $ref: '#/components/messages/ProbeTemplateDeleted'
        - $ref: '#/components/messages/ProbeTemplateUploaded'
        - $ref: '#/components/messages/ProbesRemoved'
        - $ref: '#/components/messages/ReportFailure'
        - $ref: '#/components/messages/ReportSuccess'
        - $ref: '#/components/messages/TargetJvmDiscovery'
        - $ref: '#/components/messages/TemplateDeleted'
        - $ref: '#/components/messages/TemplateUploaded'
        - $ref: '#/components/messages/ThreadDumpFailure'
        - $ref: '#/components/messages/TriggerCreated'
        - $ref: '#/components/messages/TriggerDeleted'
components:
  messages:
    ThreadDumpFailure:
      name: ThreadDumpFailure
      title: Thread Dump Failure
      summary: 'Notification: ThreadDumpFailure'
      description: WebSocket notification for Thread Dump Failure events
      payload:
        type: object
        description: WebSocket notification message wrapper
        properties:
          meta:
            type: object
            description: Notification metadata
            properties:
              category:
                type: string
                const: ThreadDumpFailure
                description: Notification category identifier
            required:
            - category
          message:
            type: object
            properties:
              jobId:
                type: string
              targetId:
                type: integer
        required:
        - meta
        - message
    CredentialsStored:
      name: CredentialsStored
      title: Credentials Stored
      summary: 'Notification: CredentialsStored'
      description: WebSocket notification for Credentials Stored events
      payload:
        type: object
        description: WebSocket notification message wrapper
        properties:
          meta:
            type: object
            description: Notification metadata
            properties:
              category:
                type: string
                const: CredentialsStored
                description: Notification category identifier
            required:
            - category
          message:
            type: object
            properties:
              id:
                type: integer
              matchExpression:
                type: object
                properties:
                  script:
                    type: string
              targets:
                type: array
        required:
        - meta
        - message
    TriggerCreated:
      name: TriggerCreated
      title: Trigger Created
      summary: 'Notification: TriggerCreated'
      description: WebSocket notification for Trigger Created events
      payload:
        type: object
        description: WebSocket notification message wrapper
        properties:
          meta:
            type: object
            description: Notification metadata
            properties:
              category:
                type: string
                const: TriggerCreated
                description: Notification category identifier
            required:
            - category
          message:
            type: object
            additionalProperties: true
        required:
        - meta
        - message
    HeapDumpFailure:
      name: HeapDumpFailure
      title: Heap Dump Failure
      summary: 'Notification: HeapDumpFailure'
      description: WebSocket notification for Heap Dump Failure events
      payload:
        type: object
        description: WebSocket notification message wrapper
        properties:
          meta:
            type: object
            description: Notification metadata
            properties:
              category:
                type: string
                const: HeapDumpFailure
                description: Notification category identifier
            required:
            - category
          message:
            type: object
            properties:
              jobId:
                type: string
        required:
        - meta
        - message
    ReportSuccess:
      name: ReportSuccess
      title: Report Success
      summary: 'Notification: ReportSuccess'
      description: WebSocket notification for Report Success events
      payload:
        type: object
        description: WebSocket notification message wrapper
        properties:
          meta:
            type: object
            description: Notification metadata
            properties:
              category:
                type: string
                const: ReportSuccess
                description: Notification category identifier
            required:
            - category
          message:
            type: object
            properties:
              jobId:
                type: string
              jvmId:
                type: string
        required:
        - meta
        - message
    ArchiveRecordingFailure:
      name: ArchiveRecordingFailure
      title: Archive Recording Failure
      summary: 'Notification: ArchiveRecordingFailure'
      description: WebSocket notification for Archive Recording Failure events
      payload:
        type: object
        description: WebSocket notification message wrapper
        properties:
          meta:
            type: object
            description: Notification metadata
            properties:
              category:
                type: string
                const: ArchiveRecordingFailure
                description: Notification category identifier
            required:
            - category
          message:
            type: object
            properties:
              jobId:
                type: string
        required:
        - meta
        - message
    ProbeTemplateApplied:
      name: ProbeTemplateApplied
      title: Probe Template Applied
      summary: 'Notification: ProbeTemplateApplied'
      description: WebSocket notification for Probe Template Applied events
      payload:
        type: object
        description: WebSocket notification message wrapper
        properties:
          meta:
            type: object
            description: Notification metadata
            properties:
              category:
                type: string
                const: ProbeTemplateApplied
                description: Notification category identifier
            required:
            - category
          message:
            type: object
            properties:
              jvmId:
                type: string
              probeTemplate:
                type: string
        required:
        - meta
        - message
    TemplateDeleted:
      name: TemplateDeleted
      title: Template Deleted
      summary: 'Notification: TemplateDeleted'
      description: WebSocket notification for Template Deleted events
      payload:
        type: object
        description: WebSocket notification message wrapper
        properties:
          meta:
            type: object
            description: Notification metadata
            properties:
              category:
                type: string
                const: TemplateDeleted
                description: Notification category identifier
            required:
            - category
          message:
            type: object
            properties:
              template:
                type: string
        required:
        - meta
        - message
    ProbeTemplateUploaded:
      name: ProbeTemplateUploaded
      title: Probe Template Uploaded
      summary: 'Notification: ProbeTemplateUploaded'
      description: WebSocket notification for Probe Template Uploaded events
      payload:
        type: object
        description: WebSocket notification message wrapper
        properties:
          meta:
            type: object
            description: Notification metadata
            properties:
              category:
                type: string
                const: ProbeTemplateUploaded
                description: Notification category identifier
            required:
            - category
          message:
            type: object
            properties:
              probeTemplate:
                type: string
              templateContent:
                type: string
        required:
        - meta
        - message
    TriggerDeleted:
      name: TriggerDeleted
      title: Trigger Deleted
      summary: 'Notification: TriggerDeleted'
      description: WebSocket notification for Trigger Deleted events
      payload:
        type: object
        description: WebSocket notification message wrapper
        properties:
          meta:
            type: object
            description: Notification metadata
            properties:
              category:
                type: string
                const: TriggerDeleted
                description: Notification category identifier
            required:
            - category
          message:
            type: object
            additionalProperties: true
        required:
        - meta
        - message
    ProbesRemoved:
      name: ProbesRemoved
      title: Probes Removed
      summary: 'Notification: ProbesRemoved'
      description: WebSocket notification for Probes Removed events
      payload:
        type: object
        description: WebSocket notification message wrapper
        properties:
          meta:
            type: object
            description: Notification metadata
            properties:
              category:
                type: string
                const: ProbesRemoved
                description: Notification category identifier
            required:
            - category
          message:
            type: object
            properties:
              jvmId:
                type: string
              target:
                type: string
        required:
        - meta
        - message
    GrafanaUploadSuccess:
      name: GrafanaUploadSuccess
      title: Grafana Upload Success
      summary: 'Notification: GrafanaUploadSuccess'
      description: WebSocket notification for Grafana Upload Success events
      payload:
        type: object
        description: WebSocket notification message wrapper
        properties:
          meta:
            type: object
            description: Notification metadata
            properties:
              category:
                type: string
                const: GrafanaUploadSuccess
                description: Notification category identifier
            required:
            - category
          message:
            type: object
            properties:
              jobId:
                type: string
        required:
        - meta
        - message
    CredentialsDeleted:
      name: CredentialsDeleted
      title: Credentials Deleted
      summary: 'Notification: CredentialsDeleted'
      description: WebSocket notification for Credentials Deleted events
      payload:
        type: object
        description: WebSocket notification message wrapper
        properties:
          meta:
            type: object
            description: Notification metadata
            properties:
              category:
                type: string
                const: CredentialsDeleted
                description: Notification category identifier
            required:
            - category
          message:
            type: object
            properties:
              id:
                type: integer
              matchExpression:
                type: object
                properties:
                  script:
                    type: string
              targets:
                type: array
        required:
        - meta
        - message
    GrafanaUploadFailure:
      name: GrafanaUploadFailure
      title: Grafana Upload Failure
      summary: 'Notification: GrafanaUploadFailure'
      description: WebSocket notification for Grafana Upload Failure events
      payload:
        type: object
        description: WebSocket notification message wrapper
        properties:
          meta:
            type: object
            description: Notification metadata
            properties:
              category:
                type: string
                const: GrafanaUploadFailure
                description: Notification category identifier
            required:
            - category
          message:
            type: object
            properties:
              jobId:
                type: string
        required:
        - meta
        - message
    TemplateUploaded:
      name: TemplateUploaded
      title: Template Uploaded
      summary: 'Notification: TemplateUploaded'
      description: WebSocket notification for Template Uploaded events
      payload:
        type: object
        description: WebSocket notification message wrapper
        properties:
          meta:
            type: object
            description: Notification metadata
            properties:
              category:
                type: string
                const: TemplateUploaded
                description: Notification category identifier
            required:
            - category
          message:
            type: object
            properties:
              template:
                type: string
        required:
        - meta
        - message
    CredentialsUpdated:
      name: CredentialsUpdated
      title: Credentials Updated
      summary: 'Notification: CredentialsUpdated'
      description: WebSocket notification for Credentials Updated events
      payload:
        type: object
        description: WebSocket notification message wrapper
        properties:
          meta:
            type: object
            description: Notification metadata
            properties:
              category:
                type: string
                const: CredentialsUpdated
                description: Notification category identifier
            required:
            - category
          message:
            type: object
            properties:
              id:
                type: integer
              matchExpression:
                type: object
                properties:
                  script:
                    type: string
              targets:
                type: array
        required:
        - meta
        - message
    TargetJvmDiscovery:
      name: TargetJvmDiscovery
      title: Target Jvm Discovery
      summary: 'Notification: TargetJvmDiscovery'
      description: WebSocket notification for Target Jvm Discovery events
      payload:
        type: object
        description: WebSocket notification message wrapper
        properties:
          meta:
            type: object
            description: Notification metadata
            properties:
              category:
                type: string
                const: TargetJvmDiscovery
                description: Notification category identifier
            required:
            - category
          message:
            type: object
            properties:
              event:
                type: object
                properties:
                  kind:
                    type: object
                    description: Payload of type EventKind
                  serviceRef:
                    type: object
                    properties:
                      connectUrl:
                        type: object
                        description: Payload of type URI
                      alias:
                        type: string
                      jvmId:
                        type: string
                      labels:
                        type: object
                        additionalProperties: true
                      annotations:
                        type: object
                        properties:
                          platform:
                            type: object
                            additionalProperties: true
                          cryostat:
                            type: object
                            additionalProperties: true
                      activeRecordings:
                        type: array
                      discoveryNode:
                        type: object
                        properties:
                          name:
                            type: string
                          nodeType:
                            type: string
                          labels:
                            type: object
                            additionalProperties: true
                          children:
                            type: array
                          parent:
                            type: object
                            description: Payload of type DiscoveryNode
                          target:
                            type: object
                            description: Payload of type Target
                  jvmId:
                    type: string
        required:
        - meta
        - message
    HeapDumpSuccess:
      name: HeapDumpSuccess
      title: Heap Dump Success
      summary: 'Notification: HeapDumpSuccess'
      description: WebSocket notification for Heap Dump Success events
      payload:
        type: object
        description: WebSocket notification message wrapper
        properties:
          meta:
            type: object
            description: Notification metadata
            properties:
              category:
                type: string
                const: HeapDumpSuccess
                description: Notification category identifier
            required:
            - category
          message:
            type: object
            properties:
              jobId:
                type: string
              targetAlias:
                type: string
        required:
        - meta
        - message
    ArchiveRecordingSuccess:
      name: ArchiveRecordingSuccess
      title: Archive Recording Success
      summary: 'Notification: ArchiveRecordingSuccess'
      description: WebSocket notification for Archive Recording Success events
      payload:
        type: object
        description: WebSocket notification message wrapper
        properties:
          meta:
            type: object
            description: Notification metadata
            properties:
              category:
                type: string
                const: ArchiveRecordingSuccess
                description: Notification category identifier
            required:
            - category
          message:
            type: object
            properties:
              jobId:
                type: string
              recording:
                type: string
              reportUrl:
                type: string
              downloadUrl:
                type: string
        required:
        - meta
        - message
    ProbeTemplateDeleted:
      name: ProbeTemplateDeleted
      title: Probe Template Deleted
      summary: 'Notification: ProbeTemplateDeleted'
      description: WebSocket notification for Probe Template Deleted events
      payload:
        type: object
        description: WebSocket notification message wrapper
        properties:
          meta:
            type: object
            description: Notification metadata
            properties:
              category:
                type: string
                const: ProbeTemplateDeleted
                description: Notification category identifier
            required:
            - category
          message:
            type: object
            properties:
              probeTemplate:
                type: string
        required:
        - meta
        - message
    ReportFailure:
      name: ReportFailure
      title: Report Failure
      summary: 'Notification: ReportFailure'
      description: WebSocket notification for Report Failure events
      payload:
        type: object
        description: WebSocket notification message wrapper
        properties:
          meta:
            type: object
            description: Notification metadata
            properties:
              category:
                type: string
                const: ReportFailure
                description: Notification category identifier
            required:
            - category
          message:
            type: object
            properties:
              jobId:
                type: string
        required:
        - meta
        - message
  schemas: {
    }
